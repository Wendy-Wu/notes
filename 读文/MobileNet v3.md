# MobileNet v3

## 1. 2019年Google提出的轻量级神经网络结构

旨在在移动设备上实现高效的图像识别和分类。

## 2. 主要包括以下几个关键组件

- 基础模块 Base Module：使用了一种“倒残差”的基础模块结构。该结构采用了深度可分离卷积和线性瓶颈，以**减少参数数量和计算复杂度**。
- Squeeze-and-Excitation模块：通过学习通道之间的相互关系，动态地调整通道权重，以增强模型的表征能力。
- Hard-Swish激活函数：与传统的ReLu激活函数相比，具有更快的计算速度和更好的性能。
- 在网络结构上进行了优化，包括通过网络宽度和分辨率的动态调整，以适应不同的计算资源和任务需求。



## 3. 前向传播

前向传播给出神经网络对给定输入的预测结果，这是神经网络用于推理时的主要步骤。就是从输入到输出，计算的过程。如代码：

```python
class SimpleNN(nn.Module):
    def __init__(self):
        super(SimpleNN, self).__init__()
        self.layer1 = nn.Linear(10, 5)  # 输入维度为10，输出维度为5
        self.layer2 = nn.Linear(5, 2)   # 输入维度为5，输出维度为2
        
def forward(self, x):
    x = self.layer1(x)  # 第1层：全连接层
    x = torch.relu(x)   # 使用ReLU激活函数
    x = self.layer2(x)  # 第2层：全连接层
    return x            # 返回最终输出
```

**第一步**：`x = self.layer1(x)`：输入 `x` 通过第一层，执行矩阵乘法 `W1 * x + b1`，并得到一个新的张量。

**第二步**：`x = torch.relu(x)`：通过激活函数 `ReLU`，将非线性引入网络。

**第三步**：`x = self.layer2(x)`：通过第二层执行相同的线性运算，得到最终的输出。

**返回值**：`forward` 函数的最后会返回最终计算的输出结果，这就是前向传播得到的模型预测值。



## 4. 批量归一化

**归一化处理**（Normalization）是指将数据的数值范围转换为一个特定的范围，通常是 `[0, 1]` 或 `[-1, 1]`，使数据具有相似的尺度或范围，从而提高模型的性能和收敛速度。

如果不同特征的数值范围差别很大（例如，有的特征值在0-1之间，而有的特征值可以达到上千甚至更大），这些差异会导致模型训练过程中某些特征对损失函数的影响过大，而其他特征影响太小，从而降低模型的效果。

神经网络中的激活函数（如`sigmoid`、`tanh`等）在输入值较大或较小时可能会饱和，导致梯度消失问题，使得网络的训练变得困难。归一化后，输入值的范围被限制在合理的区间内，网络能够更稳定地训练。

- 归一化的应用场景：
  - **图像处理**：图像像素值通常在 `[0, 255]` 之间，将其归一化到 `[0, 1]` 或 `[-1, 1]` 之间有助于神经网络更快收敛。
  - **深度学习中的批归一化（Batch Normalization）**：在训练神经网络时，常常在每个批次内对数据进行归一化，防止梯度消失或爆炸，保证训练的稳定性。
  - **数据预处理**：在传统的机器学习模型中（如SVM、KNN、线性回归等），归一化处理是常规的预处理步骤，尤其是在特征具有不同量纲时，归一化非常重要。
- 常见的归一化方法：
  - **Min-Max 归一化**：
    - **公式**：将数据缩放到 `[0, 1]` 范围。 $⁡x' = \frac{x - x_{\min}}{x_{\max} - x_{\min}}$
    - 其中，`x` 是原始数据，`x'` 是归一化后的数据，`x_{\min}` 和 `x_{\max}` 分别是数据集的最小值和最大值。
    - **适用场景**：当数据具有已知的最大值和最小值时适用，比如图像数据。
  - **Z-score 归一化（标准化）**：
    - **公式**：将数据变换为均值为0，标准差为1的标准正态分布。$ x' = \frac{x - \mu}{\sigma}$
    - 其中，`x` 是原始数据，`x'` 是标准化后的数据，`μ` 是数据的均值，`σ` 是标准差。
    - **适用场景**：适合数据分布接近正态分布的场景，且不确定最大或最小值的情况下。
  - **最大绝对值归一化**：
    - **公式**：将数据缩放到 `[-1, 1]` 之间。 $x' = \frac{x}{|x_{\max}|}$
    - 其中 `x_{\max}` 是数据集中绝对值最大的元素。
    - **适用场景**：适用于数据中心对称于0，且包含负值的情况。
  - **L2 归一化（向量归一化）**：
    - **公式**：将数据的每个特征值除以该数据的欧几里得范数（L2范数）。 $x' = \frac{x}{\|x\|}$
    - **适用场景**：多用于文本或向量数据处理（如词嵌入、文档嵌入等），将向量长度标准化为1。

